# 中间代码中的类型信息

一般来说，编译器在把源程序转换为目标机器的汇编程序或者机器代码的过程中，除了直接生成机器指令来实现一些功能以外，有时还会调用运行时库函数所提供的功能。所谓的运行时库（runtime library），是指一系列预先实现好的函数的集合（请注意跟Decaf语言规范中的“标准库函数”不同），这些函数往往是针对特定的运行平台实现的，帮助编程语言实现一些平台相关的功能，例如C语言中的libc库（在windows平台上通常是MSVCRT.dll），又例如Java语言的类库（例如rt.jar）等。通常，这样的运行库是随着所使用的编译器（或者解释器）的不同而不同的。

在Decaf中，为了实现一些平台相关的功能，我们也提供了一系列的运行时库函数，这些函数涉及到内存动态分配、输入输出等等功能。这些函数我们都定义在lowlevel.tac.Intrinsic中，通过DirectCall的方式来进行调用。注意库函数调用的传参方式和其他函数调用是一样的，也需要事先push参数。具体调用方法可以参考框架中给出的一些例子。

以下是对Decaf运行时库中所提供的八种运行时库函数的具体介绍：

##### Intrinsic.ALLOCATE
功能：分配内存，如果失败则自动退出程序

参数个数：1

参数1：为要分配的内存块大小（单位为字节）

返回：该内存块的首地址
##### Intrinsic.READ_LINE
功能：读取一行字符串（最大63个字符）

参数个数：0

返回：读到的字符串首地址
##### Intrinsic.READ_INT
功能：读取一个整数

参数个数：0

返回：读到的整数
##### Intrinsic.STRING_EQUAL
功能：比较两个字符串

参数个数：2

参数1，2：要比较的两个字符串的首地址

返回：若相等则返回true，否则返回false
##### Intrinsic.PRINT_INT
功能：打印一个整数

参数个数：1

参数1：要打印的数字

返回：无
##### Intrinsic.PRINT_STRING
功能：打印一个字符串

参数个数：1

参数1：要打印的字符串首地址

返回：无
##### Intrinsic. PRINT_BOOL
功能：打印一个布尔值

参数个数：1

参数1：要打印的布尔变量

返回：无
##### Intrinsic.HALT
功能：结束程序，可以作为子程序调用，也可以直接JUMP

参数个数：0

返回：无